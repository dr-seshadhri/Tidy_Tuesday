---
title: "FIDE_Chess_Rating"
author: "Seshadhri S"
date: "`r Sys.Date()`"
output:
  pdf_document: default
  html_document: default
---

```{r}
fide_ratings_august <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2025/2025-09-23/fide_ratings_august.csv')
fide_ratings_september <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2025/2025-09-23/fide_ratings_september.csv')

library(tidyverse)
library(ggplot2)
```

This week we're exploring August and September chess player rating data from FIDE (the International Chess Federation). Monthly data files are published on the FIDE website.

A chess rating (Elo) is an estimate of a player's strength relative to other players. If a player performs better or worse than expected, their rating increases or decreases accordingly.

The September 2025 rating list was shaped primarily by results from the Sinquefield Cup, Quantbox Chennai Grand Masters, 61st International Akiba Rubinstein Chess Festival, and the Spanish League Honor Division 2025 â€“ a Swiss team tournament held in Linares.

Which players showed the greatest improvement from August to September?

```{r}
august_rating <- fide_ratings_august %>% select(name, rating)
september_rating <- fide_ratings_september %>% select(name,rating)

colnames(august_rating)[2] <- "august_rating"
colnames(september_rating)[2] <- "september_rating"

combined_august_september <- merge(august_rating, september_rating, by = "name")
combined_august_september <- combined_august_september %>% mutate(difference = september_rating - august_rating) %>% arrange(desc(difference)) %>% head(n=10)
print(combined_august_september)

combined_august_september_long <- combined_august_september %>% pivot_longer(cols = c(august_rating, september_rating), names_to = "month", values_to = "rating")

# Grouped
ggplot(combined_august_september_long, aes(fill=month, y=rating, x=name)) + 
  geom_bar(position="dodge", stat="identity") +
  labs(x = "Name", y= "Rating", fill = "Month/Metric") +
  theme_minimal()+
  theme(
    axis.text.x = element_text(angle=45, hjust= 1)
  )

```

Which federations have the most number of titled players?

```{r}
august_september_all <- merge(fide_ratings_august, fide_ratings_september, by = "name")
all_players <- august_september_all %>% select(name, fed.x, title.x)
colnames(all_players)[1] <- "Name"
colnames(all_players)[2] <- "Federation"
colnames(all_players)[3] <- "Title"

all_players <- na.omit(all_players)
all_players <- all_players %>% group_by(Federation) %>% summarise(total_titles=n(), .groups="drop") %>% arrange(desc(total_titles))
print(head(all_players))

```

How did the rankings of the top male or female players change?

```{r}
male_players_august <- fide_ratings_august %>% select(name, sex, rating) %>% filter(sex == "M")
female_players_august <- fide_ratings_august %>% select(name, sex, rating) %>% filter(sex == "F")

male_players_september <- fide_ratings_september %>% select(name, sex, rating) %>% filter(sex == "M")
female_players_september <- fide_ratings_september %>% select(name, sex, rating) %>% filter(sex == "F")

male_combined <- merge(male_players_august, male_players_september, by = "name") %>% 
  select(name, rating.x, rating.y)
colnames(male_combined)[2] <- "Rating_August"
colnames(male_combined)[3] <- "Rating_September"
male_combined <- male_combined %>% mutate(Difference = Rating_September - Rating_August) 
top_male <- male_combined %>% arrange(desc(Rating_September)) %>% head(n=10)
print(top_male)

female_combined <- merge(female_players_august, female_players_september, by = "name") %>% 
  select(name, rating.x, rating.y)
colnames(female_combined)[2] <- "Rating_August"
colnames(female_combined)[3] <- "Rating_September"
female_combined <- female_combined %>% mutate(Difference = Rating_September - Rating_August) 
top_female <- female_combined %>% arrange(desc(Rating_September)) %>% head(n=10)
print(top_female)

```

Who are the top youth players?

```{r}
youth_players <- august_september_all %>% filter(bday.x >= 2007)
top_youth <- youth_players %>% select(name, fed.x, bday.x, rating.y) %>% arrange(desc(rating.y))
print(head(top_youth, 10))

```